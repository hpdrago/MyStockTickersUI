<p-dataTable [value]="rows"
             selectionMode="single"
             [(selection)]="selectedModelObject"
             (onRowSelect)="onRowSelect($event)"
             (onRowUnselect)="onRowUnSelect($event)"
             [paginator]="true"
             [pageLinks]="6"
             [rowsPerPageOptions]="[10,20,30,40,50]"
             [rows]="10"
             [loading]="loading"
             [totalRecords]="totalRows"
             [lazy]="true"
             (onLazyLoad)="lazyLoadTable($event)"
             (onRowDblclick)="onRowDoubleClick($event)"
             [responsive]="true">

    <p-header>
        <stock-notes-table-buttons>
        </stock-notes-table-buttons>
    </p-header>

    <!----------------------------------------------------------------------------------------------------------
    TICKER SYMBOL
    ------------------------------------------------------------------------------------------------------------>
    <p-column id="tickerSymbolColumn"
              field="tickerSymbol"
              header="Ticker"
              [style]="{'width':'50px'}"
              [sortable]="true">
    </p-column>

    <!----------------------------------------------------------------------------------------------------------
    NOTES DATE
    ------------------------------------------------------------------------------------------------------------>
    <p-column id="notesDateColumn"
              field="notesDate"
              header="Date"
              [style]="{'width':'80px'}"
              [sortable]="true">
        <ng-template let-col let-stockNotes="rowData" pTemplate="body">
            {{stockNotes[col.field] | date: 'y-MM-dd' }}
        </ng-template>
    </p-column>

    <!----------------------------------------------------------------------------------------------------------
    STOCK PRICE WHEN CREATED
    <p-column id="stockPriceColumn"
              field="stockPriceWhenCreated"
              header="Price When Entered"
              [style]="{'width':'80px','text-align':'right'}">
        <ng-template let-col let-stockNotes="rowData" pTemplate="body">
            {{stockNotes[col.field] | currency: 'USD': true }}
        </ng-template>
    </p-column>
    ------------------------------------------------------------------------------------------------------------>

    <!----------------------------------------------------------------------------------------------------------
    LAST PRICE
    ------------------------------------------------------------------------------------------------------------>
    <p-column id="lastPrice"
              field="lastPrice"
              header="Last Price"
              [style]="{'width':'80px','text-align':'right'}">
        <ng-template let-col let-stockNotes="rowData" pTemplate="body">
            <div *ngIf="isFetchingQuote( stockNotes )">
                Loading...
            </div>
            <div *ngIf="!isFetchingQuote( stockNotes )">
                {{stockNotes[col.field] | currency: 'USD': true }}
            </div>
        </ng-template>
    </p-column>

    <!----------------------------------------------------------------------------------------------------------
    LAST PRICE DATE
    ------------------------------------------------------------------------------------------------------------>
    <!--
    <p-column id="lastPriceChangeColumn"
              field="lastPriceChange"
              header="Last Price Change "
              [style]="{'width':'80px'}"
              [sortable]="true">
        <ng-template let-col let-stockNotes="rowData" pTemplate="body">
            {{stockNotes[col.field] | date: 'y-MM-dd h:mm a' }}
        </ng-template>
    </p-column>
    -->

    <!----------------------------------------------------------------------------------------------------------
    PERCENT OF CHANGE
    ------------------------------------------------------------------------------------------------------------>
    <p-column id="percentChange"
              field="percentChange"
              header="% Change Since Entered"
              [style]="{'width':'80px','text-align':'right'}">
        <ng-template let-col let-stockNotes="rowData" pTemplate="body">
            <div class="positiveGain" *ngIf="calculatePercentChange( stockNotes ) >= 0.0">
                {{calculatePercentChange( stockNotes ) | percent: '1.2-2' }}
            </div>
            <div class="negativeGain" *ngIf="calculatePercentChange( stockNotes ) < 0.0">
                {{calculatePercentChange( stockNotes ) | percent: '1.2-2' }}
            </div>
        </ng-template>
    </p-column>

    <!----------------------------------------------------------------------------------------------------------
    ACTION TAKEN
    <p-column id="actionTakenColumn"
              field="actionTaken"
              header="Action Taken"
              [style]="{'width':'80px'}"
              [sortable]="true">
        <ng-template let-col let-stockNotes="rowData" pTemplate="body">
            {{getActionTaken( stockNotes[col.field] )}}
        </ng-template>
    </p-column>
    ------------------------------------------------------------------------------------------------------------>

    <!----------------------------------------------------------------------------------------------------------
    ACTION TAKEN SHARES
    <p-column id="actionTakenSharesColumn"
              field="actionTakenShares"
              header="Action Shares"
              [style]="{'width':'80px','text-align':'right'}"
              [sortable]="true">
    </p-column>
    ------------------------------------------------------------------------------------------------------------>

    <!----------------------------------------------------------------------------------------------------------
    NOTES SOURCE
    <p-column id="source"
              field="notesSourceName"
              header="Source"
              [style]="{'width':'120px'}"
              [sortable]="true">
    </p-column>
    ------------------------------------------------------------------------------------------------------------>

    <!----------------------------------------------------------------------------------------------------------
    TAGS
    <p-column id="tags"
              field="tags"
              header="Tags"
              [style]="{'width':'120px'}"
              [sortable]="true">
    </p-column>
    ------------------------------------------------------------------------------------------------------------>

    <!----------------------------------------------------------------------------------------------------------
    BULL OR BEAR
    <p-column id="bullOrBearColumn"
              field="bullOrBear"
              header="Bull or Bear"
              [style]="{'width':'80px'}"
              [sortable]="true">
        <ng-template let-col let-stockNotes="rowData" pTemplate="body">
            {{getBullOrBear( stockNotes[col.field] )}}
        </ng-template>
    </p-column>
    ------------------------------------------------------------------------------------------------------------>

    <!----------------------------------------------------------------------------------------------------------
    NOTES
    ------------------------------------------------------------------------------------------------------------>
    <p-column id="notesColumn"
              field="notes"
              header="Notes">
        <ng-template let-col let-stockNotes="rowData" pTemplate="body">
            <div *ngIf="urlMap.getURL( stockNotes.tickerSymbol ) == null">
                <div [innerHTML]="truncateNotes( stockNotes[col.field] )">
                </div>
            </div>
            <div *ngIf="urlMap.getURL( stockNotes.tickerSymbol ) != null " >
                <a href="{{urlMap.getURL( stockNotes.tickerSymbol )}}" target="_blank">
                    <div [innerHTML]="truncateNotes( stockNotes[col.field] )">
                    </div>
                </a>
            </div>
        </ng-template>
    </p-column>

    <p-footer>
        <stock-notes-table-buttons>
        </stock-notes-table-buttons>
    </p-footer>
    <stock-notes-dialog>
    </stock-notes-dialog>
</p-dataTable>
